<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alliance Girls High School - Secure Report Card</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%);
            color: #333;
            min-height: 100vh;
            font-family: 'Inter', 'Segoe UI', 'Arial', sans-serif;
            position: relative;
            padding: 20px;
            overflow-x: hidden;
        }

        /* Security Background Patterns */
        .security-bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.15;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(7, 88, 36, 0.08) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(155, 174, 48, 0.08) 0%, transparent 20%),
                repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(7, 88, 36, 0.03) 2px, rgba(7, 88, 36, 0.03) 4px),
                repeating-linear-gradient(-45deg, transparent, transparent 2px, rgba(155, 174, 48, 0.03) 2px, rgba(155, 174, 48, 0.03) 4px);
        }

        /* Main Container - Spacious Layout */
        .report-card-container {
            width: 100%;
            max-width: 1400px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
            padding: 40px;
            margin: 0 auto 40px;
            position: relative;
            overflow: visible;
            border: 1px solid #c9d6c3;
            background-image: 
                linear-gradient(rgba(255,255,255,0.98), rgba(255,255,255,0.98)),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"><path d="M20,20 L180,180 M180,20 L20,180" stroke="rgba(7, 88, 36, 0.015)" stroke-width="1"/><circle cx="100" cy="100" r="80" fill="none" stroke="rgba(155, 174, 48, 0.015)" stroke-width="1"/></svg>');
        }

        /* Page indicators */
        .page-indicator {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0 40px;
        }

        .page-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #d0d9d3;
            cursor: pointer;
            transition: all 0.3s;
        }

        .page-dot.active {
            background: #075824;
            transform: scale(1.2);
        }

        /* Security Background Elements */
        .security-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.03;
        }

        .micro-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(45deg, transparent, transparent 20px, rgba(7, 88, 36, 0.05) 20px, rgba(7, 88, 36, 0.05) 40px),
                repeating-linear-gradient(-45deg, transparent, transparent 20px, rgba(155, 174, 48, 0.05) 20px, rgba(155, 174, 48, 0.05) 40px);
        }

        .watermark {
            position: absolute;
            font-family: 'Libre Baskerville', serif;
            font-size: 140px;
            color: rgba(7, 88, 36, 0.02);
            transform: rotate(-45deg);
            top: 35%;
            left: 15%;
            white-space: nowrap;
            font-weight: bold;
            letter-spacing: 8px;
        }

        .serial-number {
            position: absolute;
            bottom: 20px;
            right: 25px;
            font-size: 12px;
            color: #666;
            letter-spacing: 1.5px;
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        /* Print-specific adjustments */
        @media print {
            body {
                background: white;
                padding: 0;
                overflow: hidden;
            }
            
            .report-card-container {
                box-shadow: none;
                margin: 0;
                padding: 25px 30px;
                min-width: 210mm;
                max-width: 210mm;
                border: none;
                border-radius: 0;
                page-break-after: always;
            }
            
            .no-print {
                display: none !important;
            }
            
            .security-background {
                opacity: 0.08;
            }
            
            .watermark {
                font-size: 120px;
            }
            
            .page-indicator {
                display: none !important;
            }
            
            .security-bg-pattern {
                opacity: 0.1;
            }
        }

        /* Header Section - Spacious */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 30px;
            border-bottom: 4px double #075824;
            margin-bottom: 35px;
            position: relative;
            z-index: 1;
        }

        .school-logo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background: white;
            border: 5px solid #075824;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            flex-shrink: 0;
        }

        .school-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            padding: 10px;
        }

        .school-name {
            text-align: center;
            flex-grow: 1;
            margin: 0 40px;
        }

        .school-name h1 {
            font-family: 'Libre Baskerville', serif;
            font-size: 38px;
            color: #075824;
            letter-spacing: 1.5px;
            margin-bottom: 10px;
            line-height: 1.2;
        }

        .school-name p {
            color: #377437;
            font-size: 20px;
            font-style: italic;
            font-weight: 500;
        }

        .report-title {
            text-align: right;
            flex-shrink: 0;
            min-width: 220px;
        }

        .report-title h2 {
            font-size: 32px;
            color: #075824;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .report-title p {
            font-size: 18px;
            color: #5D8B70;
            font-weight: 500;
        }

        /* Student Info Section - Spacious */
        .student-info {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 25px;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 3px solid #dde7e0;
            position: relative;
            z-index: 1;
        }

        .info-field {
            display: flex;
            flex-direction: column;
        }

        .info-field.full-width {
            grid-column: span 2;
        }

        .info-field label {
            font-size: 14px;
            color: #5D8B70;
            margin-bottom: 8px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .info-field input, .info-field select {
            padding: 12px 0;
            border: none;
            border-bottom: 3px solid #d0d9d3;
            font-size: 16px;
            background: transparent;
            outline: none;
            transition: all 0.3s;
            font-weight: 500;
            width: 100%;
        }

        .info-field input:focus, .info-field select:focus {
            border-bottom-color: #9BAE30;
            box-shadow: 0 3px 0 0 rgba(155, 174, 48, 0.2);
        }

        /* Main Content - Spacious Layout */
        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 40px;
            margin-bottom: 40px;
            position: relative;
            z-index: 1;
        }

        /* Subjects Section - Spacious */
        .subjects-section h2 {
            color: #075824;
            font-size: 26px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #dde7e0;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* Term Navigation */
        .term-navigation {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .term-btn {
            padding: 12px 24px;
            background: #f0f7f4;
            border: 2px solid #d0d9d3;
            border-radius: 8px;
            font-weight: 600;
            color: #5D8B70;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
        }

        .term-btn:hover {
            background: #e5efe8;
            transform: translateY(-2px);
        }

        .term-btn.active {
            background: #075824;
            color: white;
            border-color: #075824;
        }

        /* Subjects Table - Spacious */
        .subjects-table-container {
            width: 100%;
            overflow-x: auto;
            border: 2px solid #d0d9d3;
            border-radius: 10px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.05);
            background: white;
        }

        .subjects-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 14px;
        }

        .subjects-table thead {
            background: linear-gradient(to bottom, #f0f7f4 0%, #e5efe8 100%);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .subjects-table th {
            padding: 18px 12px;
            text-align: center;
            font-weight: 700;
            color: #075824;
            border: 1px solid #c9d6c3;
            font-size: 14px;
            white-space: nowrap;
            vertical-align: middle;
            min-width: 80px;
        }

        .subjects-table th.subject-col {
            text-align: left;
            width: 180px;
            min-width: 180px;
            max-width: 180px;
            overflow: hidden;
            text-overflow: ellipsis;
            padding-left: 20px;
        }

        .subjects-table th.exam-type-header {
            background-color: #e3f2fd;
            color: #1565c0;
            font-weight: 700;
            font-size: 13px;
            padding: 15px 8px;
            border: 1px solid #bbdefb;
        }

        .subjects-table th.term-header {
            background-color: #e5efe8;
            font-size: 16px;
            padding: 18px 8px;
            font-weight: 700;
            color: #075824;
        }

        .subjects-table td {
            padding: 16px 10px;
            border: 1px solid #e8f0eb;
            text-align: center;
            vertical-align: middle;
            transition: background-color 0.2s;
            min-height: 50px;
        }

        .subjects-table tr:nth-child(even) td {
            background-color: #fafefa;
        }

        .subjects-table tr:hover td {
            background-color: #f5fbf5;
        }

        .subject-cell {
            text-align: left !important;
            font-weight: 600;
            padding-left: 20px !important;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            font-size: 15px;
            background: #f9fcf8 !important;
        }

        .subject-code {
            font-size: 12px;
            color: #5D8B70;
            margin-top: 5px;
            display: block;
            font-weight: 500;
        }

        .subjects-table input {
            width: 70px;
            padding: 10px 8px;
            border: 2px solid #d0d9d3;
            border-radius: 6px;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            background: white;
        }

        .subjects-table input:focus {
            outline: none;
            border-color: #9BAE30;
            box-shadow: 0 0 0 3px rgba(155, 174, 48, 0.2);
            transform: translateY(-1px);
        }

        .subject-average {
            font-weight: 700;
            color: #075824;
            font-size: 15px;
            padding: 16px 10px !important;
            background-color: #f9fcf8 !important;
        }

        .paper-average {
            font-weight: 600;
            color: #377437;
            background-color: #f0f7f4 !important;
            font-size: 14px;
        }

        /* Grade colors */
        .grade-a { color: #10B981; background-color: rgba(16, 185, 129, 0.1) !important; }
        .grade-b { color: #34D399; background-color: rgba(52, 211, 153, 0.1) !important; }
        .grade-c { color: #FBBF24; background-color: rgba(251, 191, 36, 0.1) !important; }
        .grade-d { color: #F59E0B; background-color: rgba(245, 158, 11, 0.1) !important; }
        .grade-e { color: #F97316; background-color: rgba(249, 115, 22, 0.1) !important; }
        .grade-f { color: #EF4444; background-color: rgba(239, 68, 68, 0.1) !important; }

        /* Right Column Sections - Spacious */
        .grading-box, .performance-graph, .comments-box {
            background: linear-gradient(to bottom, #f9fcf8 0%, #f0f7f4 100%);
            border: 3px solid #d0d9d3;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.05);
        }

        .grading-box h3, .performance-graph h3, .comments-box h3 {
            color: #075824;
            margin-bottom: 25px;
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .grading-box h3 i, .performance-graph h3 i, .comments-box h3 i {
            color: #9BAE30;
            font-size: 24px;
        }

        /* Grading System */
        .grading-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            font-size: 14px;
        }

        .grade-item {
            display: flex;
            justify-content: space-between;
            padding: 15px 18px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e5efe8;
            align-items: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .grade-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .grade-range {
            font-weight: 700;
            color: #075824;
            font-size: 15px;
        }

        /* Performance Graph */
        .graph-container {
            width: 100%;
            height: 250px;
            position: relative;
        }

        /* Comments Section */
        .comments-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .comments-box textarea {
            width: 100%;
            height: 150px;
            padding: 20px;
            border: 2px solid #d0d9d3;
            border-radius: 10px;
            font-size: 15px;
            resize: none;
            line-height: 1.6;
            font-family: 'Inter', sans-serif;
            font-weight: 400;
        }

        .comments-box textarea:focus {
            outline: none;
            border-color: #9BAE30;
            box-shadow: 0 0 0 3px rgba(155, 174, 48, 0.2);
        }

        /* Bottom Section - Spacious */
        .bottom-section {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 35px;
            margin-top: 40px;
            padding-top: 40px;
            border-top: 4px solid #dde7e0;
            position: relative;
            z-index: 1;
        }

        .attendance-section h3, .ranks-section h3, .final-grades-section h3 {
            color: #075824;
            font-size: 22px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #dde7e0;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .attendance-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 16px;
            border: 2px solid #d0d9d3;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .attendance-table td {
            padding: 18px;
            border: 1px solid #d0d9d3;
        }

        .attendance-table td:first-child {
            font-weight: 600;
            width: 70%;
            background-color: #f9fcf8;
        }

        .attendance-table input {
            width: 120px;
            padding: 12px;
            border: 2px solid #d0d9d3;
            border-radius: 8px;
            text-align: center;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .attendance-table input:focus {
            outline: none;
            border-color: #9BAE30;
            box-shadow: 0 0 0 3px rgba(155, 174, 48, 0.2);
        }

        /* Ranks Section */
        .ranks-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
        }

        .rank-item {
            background: linear-gradient(145deg, #f5f9f7 0%, #e5efe8 100%);
            border-radius: 15px;
            padding: 30px 25px;
            text-align: center;
            border: 3px solid #d0d9d3;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .rank-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
        }

        .rank-item label {
            display: block;
            font-size: 15px;
            color: #5D8B70;
            margin-bottom: 15px;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .rank-value {
            font-size: 42px;
            font-weight: 800;
            color: #075824;
            margin-bottom: 8px;
        }

        .rank-total {
            font-size: 14px;
            color: #777;
            font-weight: 500;
        }

        /* Final Grades */
        .final-grades-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
        }

        .final-grade-item {
            background: linear-gradient(145deg, #f5f9f7 0%, #e5efe8 100%);
            border-radius: 15px;
            padding: 30px 25px;
            text-align: center;
            border: 3px solid #d0d9d3;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .final-grade-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
        }

        .final-grade-item label {
            display: block;
            font-size: 15px;
            color: #5D8B70;
            margin-bottom: 15px;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .final-grade-value {
            font-size: 42px;
            font-weight: 800;
            color: #075824;
        }

        /* Security QR Code */
        .security-qr {
            text-align: center;
            margin-top: 45px;
            padding: 30px;
            border-top: 4px dashed #d0d9d3;
            position: relative;
            z-index: 1;
            background: linear-gradient(to right, #f9fcf8 0%, #f0f7f4 100%);
            border-radius: 15px;
        }

        .qr-container {
            display: inline-block;
            padding: 25px;
            background: white;
            border: 3px solid #d0d9d3;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .qr-code {
            width: 180px;
            height: 180px;
            background: linear-gradient(45deg, #075824 25%, #9BAE30 25%, #9BAE30 50%, #075824 50%, #075824 75%, #9BAE30 75%);
            background-size: 20px 20px;
            margin: 0 auto 20px;
            position: relative;
            border-radius: 10px;
            animation: qr-shimmer 3s infinite linear;
        }

        .qr-code::before {
            content: "";
            position: absolute;
            top: 20%;
            left: 20%;
            width: 60%;
            height: 60%;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 25px rgba(0,0,0,0.1);
        }

        @keyframes qr-shimmer {
            0% { background-position: 0 0; }
            100% { background-position: 40px 40px; }
        }

        .security-qr p {
            font-size: 16px;
            color: #555;
            margin-top: 15px;
            font-weight: 600;
        }

        /* Control Buttons - Spacious */
        .controls {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 45px;
            padding-top: 40px;
            border-top: 3px solid #dde7e0;
            position: relative;
            z-index: 1;
        }

        .btn {
            padding: 18px 40px;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
            font-size: 17px;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            min-width: 220px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-calculate {
            background: linear-gradient(135deg, #075824 0%, #0a6e2e 100%);
            color: white;
        }

        .btn-calculate:hover {
            background: linear-gradient(135deg, #05411c 0%, #075824 100%);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(7, 88, 36, 0.3);
        }

        .btn-print {
            background: linear-gradient(135deg, #377437 0%, #4a944a 100%);
            color: white;
        }

        .btn-print:hover {
            background: linear-gradient(135deg, #2a5a2a 0%, #377437 100%);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(55, 116, 55, 0.3);
        }

        .btn-reset {
            background: linear-gradient(135deg, #9BAE30 0%, #b1c94e 100%);
            color: white;
        }

        .btn-reset:hover {
            background: linear-gradient(135deg, #849926 0%, #9BAE30 100%);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(155, 174, 48, 0.3);
        }

        /* Signature Section */
        .signature-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 35px;
            margin-top: 40px;
            padding-top: 40px;
            border-top: 4px dashed #d0d9d3;
        }

        .signature-box {
            text-align: center;
            padding: 25px;
            background: #f9fcf8;
            border-radius: 12px;
            border: 3px solid #e5efe8;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.05);
        }

        .signature-box h4 {
            color: #075824;
            margin-bottom: 20px;
            font-size: 20px;
        }

        .signature-line {
            width: 80%;
            height: 2px;
            background: #333;
            margin: 50px auto 15px;
        }

        .signature-name {
            font-weight: 600;
            color: #333;
            margin-top: 8px;
            font-size: 18px;
        }

        .signature-title {
            font-size: 15px;
            color: #666;
            font-style: italic;
        }

        /* Security notice */
        .security-notice {
            position: absolute;
            bottom: 20px;
            left: 30px;
            font-size: 12px;
            color: #777;
            letter-spacing: 1px;
            font-family: 'Courier New', monospace;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Status indicator */
        .status-indicator {
            display: inline-block;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-left: 12px;
            vertical-align: middle;
            box-shadow: 0 0 12px currentColor;
        }

        /* Holographic effect for security */
        .holographic-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                rgba(255,255,255,0) 0%, 
                rgba(255,255,255,0.1) 25%, 
                rgba(255,255,255,0) 50%, 
                rgba(255,255,255,0.1) 75%, 
                rgba(255,255,255,0) 100%);
            background-size: 200% 200%;
            animation: hologram 3s infinite linear;
            pointer-events: none;
            z-index: 5;
            opacity: 0.5;
            border-radius: 12px;
        }

        @keyframes hologram {
            0% { background-position: 0% 0%; }
            100% { background-position: 200% 200%; }
        }

        /* Complex background patterns */
        .complex-pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><circle cx="20" cy="20" r="3" fill="rgba(7, 88, 36, 0.02)"/><circle cx="50" cy="50" r="3" fill="rgba(7, 88, 36, 0.02)"/><circle cx="80" cy="80" r="3" fill="rgba(7, 88, 36, 0.02)"/><path d="M10,90 L90,10" stroke="rgba(155, 174, 48, 0.02)" stroke-width="0.5"/></svg>'),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"><path d="M50,50 Q100,0 150,50 Q100,100 50,50" fill="none" stroke="rgba(7, 88, 36, 0.01)" stroke-width="0.5"/><path d="M100,100 L150,150" stroke="rgba(155, 174, 48, 0.01)" stroke-width="0.5"/></svg>');
            background-repeat: repeat;
            opacity: 0.3;
            pointer-events: none;
            z-index: 0;
        }

        /* Responsive adjustments */
        @media (max-width: 1400px) {
            .report-card-container {
                padding: 30px;
                margin: 0 auto 30px;
            }
            
            .header {
                flex-direction: column;
                gap: 25px;
                text-align: center;
            }
            
            .school-logo {
                width: 100px;
                height: 100px;
            }
            
            .school-name {
                margin: 0;
            }
            
            .report-title {
                text-align: center;
            }
            
            .student-info {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .bottom-section {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .ranks-grid, .final-grades-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .comments-section {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }
            
            .btn {
                width: 100%;
                max-width: 400px;
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .report-card-container {
                padding: 20px;
            }
            
            .student-info {
                grid-template-columns: 1fr;
            }
            
            .info-field.full-width {
                grid-column: span 1;
            }
            
            .ranks-grid, .final-grades-grid {
                grid-template-columns: 1fr;
            }
            
            .signature-section {
                grid-template-columns: 1fr;
            }
            
            .subjects-table th, .subjects-table td {
                padding: 10px 6px;
            }
            
            .subjects-table input {
                width: 60px;
                padding: 8px;
            }
        }

        /* Page transitions */
        .page {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .page.active {
            display: block;
            opacity: 1;
        }

        /* Scroll indicator */
        .scroll-indicator {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
        }

        .scroll-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #d0d9d3;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .scroll-dot.active {
            background: #075824;
            transform: scale(1.3);
        }

        /* Floating navigation */
        .floating-nav {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.15);
            display: flex;
            gap: 20px;
            z-index: 100;
            border: 2px solid #d0d9d3;
        }

        .nav-btn {
            padding: 12px 25px;
            background: #f0f7f4;
            border: 2px solid #d0d9d3;
            border-radius: 30px;
            font-weight: 600;
            color: #5D8B70;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 150px;
            text-align: center;
        }

        .nav-btn:hover {
            background: #e5efe8;
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: #075824;
            color: white;
            border-color: #075824;
        }
    </style>
</head>
<body>
    <!-- Background Security Pattern -->
    <div class="security-bg-pattern"></div>
    
    <!-- Scroll Indicator -->
    <div class="scroll-indicator no-print">
        <div class="scroll-dot" data-page="1"></div>
        <div class="scroll-dot" data-page="2"></div>
        <div class="scroll-dot" data-page="3"></div>
    </div>

    <!-- Floating Navigation -->
    <div class="floating-nav no-print">
        <button class="nav-btn" data-page="1">Page 1: Term 1</button>
        <button class="nav-btn" data-page="2">Page 2: Term 2</button>
        <button class="nav-btn" data-page="3">Page 3: Term 3</button>
    </div>

    <!-- Page 1: Term 1 -->
    <div class="report-card-container page active" id="page1">
        <!-- Holographic Overlay for Security -->
        <div class="holographic-overlay"></div>
        
        <!-- Complex Background Pattern -->
        <div class="complex-pattern"></div>
        
        <!-- Security Background Elements -->
        <div class="security-background">
            <div class="micro-pattern"></div>
            <div class="watermark">TERM 1 REPORT</div>
            <div class="serial-number" id="serialNumber">SN: AGHS-RC-2025-0247-5A8B</div>
        </div>

        <!-- Header Section -->
        <div class="header">
            <div class="school-logo">
                <img src="badge.png" alt="Alliance Girls High School Badge" onerror="this.onerror=null; this.src='https://api.dicebear.com/7.x/shapes/svg?seed=AllianceGirls'">
            </div>
            <div class="school-name">
                <h1>Alliance Girls High School</h1>
                <p>Excellence in Education Since 1975</p>
            </div>
            <div class="report-title">
                <h2>ACADEMIC REPORT</h2>
                <p>Term 1 - Comprehensive Summary</p>
            </div>
        </div>

        <!-- Student Information -->
        <div class="student-info">
            <div class="info-field full-width">
                <label for="studentName"><i class="fas fa-user-graduate"></i> Name of Student</label>
                <input type="text" id="studentName" value="Alexandra Wanjiru Johnson">
            </div>
            <div class="info-field">
                <label for="gender"><i class="fas fa-venus-mars"></i> Gender</label>
                <select id="gender">
                    <option value="Female" selected>Female</option>
                    <option value="Male">Male</option>
                </select>
            </div>
            <div class="info-field">
                <label for="yearSection"><i class="fas fa-school"></i> Year & Section</label>
                <input type="text" id="yearSection" value="Grade 12 - Science Stream A">
            </div>
            <div class="info-field">
                <label for="classAdviser"><i class="fas fa-chalkboard-teacher"></i> Class Adviser</label>
                <input type="text" id="classAdviser" value="Mr. Robert Chen">
            </div>
            <div class="info-field full-width">
                <label for="parentGuardian"><i class="fas fa-users"></i> Parent/Guardian Name</label>
                <input type="text" id="parentGuardian" value="Mr. James Johnson">
            </div>
            <div class="info-field">
                <label for="parentPhone"><i class="fas fa-phone"></i> Parent Phone</label>
                <input type="text" id="parentPhone" value="+254 712 345 678">
            </div>
            <div class="info-field">
                <label for="gradingPeriod"><i class="fas fa-calendar-alt"></i> Grading Period</label>
                <select id="gradingPeriod">
                    <option value="Term 1" selected>Term 1</option>
                    <option value="Term 2">Term 2</option>
                    <option value="Term 3">Term 3</option>
                </select>
            </div>
            <div class="info-field">
                <label for="schoolYear"><i class="fas fa-calendar"></i> School Year</label>
                <input type="text" id="schoolYear" value="2024-2025">
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Subjects Section -->
            <div class="subjects-section">
                <h2><i class="fas fa-book-open"></i> Term 1 Academic Performance</h2>
                
                <!-- Term Navigation -->
                <div class="term-navigation no-print">
                    <button class="term-btn active" data-term="1">Term 1</button>
                    <button class="term-btn" data-term="2">Term 2</button>
                    <button class="term-btn" data-term="3">Term 3</button>
                </div>

                <div class="subjects-table-container">
                    <table class="subjects-table">
                        <thead>
                            <tr>
                                <th colspan="15" class="term-header">TERM 1 ASSESSMENTS - COMPLETE SUBJECT LIST</th>
                            </tr>
                            <tr>
                                <th class="subject-col">Subject (Code)</th>
                                
                                <!-- Opener Exam -->
                                <th colspan="4" class="exam-type-header">OPENER EXAM</th>
                                
                                <!-- Mid Term -->
                                <th colspan="4" class="exam-type-header">MID TERM</th>
                                
                                <!-- End Term -->
                                <th colspan="4" class="exam-type-header">END TERM</th>
                                
                                <!-- Overall -->
                                <th class="term-header">Term Avg</th>
                                <th class="term-header">Grade</th>
                            </tr>
                            <tr>
                                <th class="subject-col">Subject Details</th>
                                
                                <!-- Paper Headers -->
                                <th>P1</th><th>P2</th><th>P3</th><th>Avg</th>
                                <th>P1</th><th>P2</th><th>P3</th><th>Avg</th>
                                <th>P1</th><th>P2</th><th>P3</th><th>Avg</th>
                                
                                <!-- Overall -->
                                <th>Avg</th>
                                <th>Grd</th>
                            </tr>
                        </thead>
                        <tbody id="subjectsTableTerm1">
                            <!-- Term 1 subjects populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Right Column - Grading & Comments -->
            <div class="grading-section">
                <div class="grading-box">
                    <h3><i class="fas fa-chart-bar"></i> Grading System</h3>
                    <div class="grading-grid" id="gradingSystem">
                        <!-- Grading system populated by JavaScript -->
                    </div>
                </div>

                <!-- Performance Graph -->
                <div class="performance-graph">
                    <h3><i class="fas fa-chart-line"></i> Performance Trend</h3>
                    <div class="graph-container">
                        <canvas id="performanceChartTerm1"></canvas>
                    </div>
                </div>

                <!-- Comments Section -->
                <div class="comments-section">
                    <div class="comments-box">
                        <h3><i class="fas fa-chalkboard-teacher"></i> Class Teacher's Comments</h3>
                        <textarea id="teacherCommentsTerm1">Excellent start to the academic year. Shows strong potential in sciences. Active participation in class discussions. Could improve time management for assignments.</textarea>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Section -->
        <div class="bottom-section">
            <div class="attendance-section">
                <h3><i class="fas fa-calendar-check"></i> Term 1 Attendance</h3>
                <table class="attendance-table">
                    <tr>
                        <td>Total School Days</td>
                        <td><input type="number" id="totalDaysTerm1" value="45" min="0"></td>
                    </tr>
                    <tr>
                        <td>Days Attended</td>
                        <td><input type="number" id="daysAttendedTerm1" value="44" min="0"></td>
                    </tr>
                    <tr>
                        <td>Days Absent</td>
                        <td><input type="number" id="daysAbsentTerm1" value="1" min="0" readonly></td>
                    </tr>
                    <tr>
                        <td>Attendance Rate</td>
                        <td><input type="text" id="attendanceRateTerm1" value="97.8%" readonly></td>
                    </tr>
                </table>
            </div>

            <div class="ranks-section">
                <h3><i class="fas fa-trophy"></i> Term 1 Ranking</h3>
                <div class="ranks-grid">
                    <div class="rank-item">
                        <label>Stream Rank</label>
                        <div class="rank-value">5</div>
                        <div class="rank-total">out of 45 students in Science A</div>
                    </div>
                    <div class="rank-item">
                        <label>Overall Rank</label>
                        <div class="rank-value">18</div>
                        <div class="rank-total">out of 280 Grade 12 students</div>
                    </div>
                </div>
            </div>

            <div class="final-grades-section">
                <h3><i class="fas fa-chart-line"></i> Term 1 Grades</h3>
                <div class="final-grades-grid">
                    <div class="final-grade-item">
                        <label>Term Average</label>
                        <div class="final-grade-value" id="termAverageTerm1">84.5</div>
                    </div>
                    <div class="final-grade-item">
                        <label>Term Grade</label>
                        <div class="final-grade-value" id="termGradeTerm1">A-</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Security Notice -->
        <div class="security-notice">
            <i class="fas fa-shield-alt"></i> SECURE DOCUMENT • TERM 1 • PAGE 1 OF 3
        </div>
    </div>

    <!-- Page 2: Term 2 -->
    <div class="report-card-container page" id="page2">
        <!-- Holographic Overlay for Security -->
        <div class="holographic-overlay"></div>
        
        <!-- Complex Background Pattern -->
        <div class="complex-pattern"></div>
        
        <!-- Security Background Elements -->
        <div class="security-background">
            <div class="micro-pattern"></div>
            <div class="watermark">TERM 2 REPORT</div>
            <div class="serial-number">SN: AGHS-RC-2025-0247-5A8B</div>
        </div>

        <!-- Header Section -->
        <div class="header">
            <div class="school-logo">
                <img src="badge.png" alt="Alliance Girls High School Badge" onerror="this.onerror=null; this.src='https://api.dicebear.com/7.x/shapes/svg?seed=AllianceGirls'">
            </div>
            <div class="school-name">
                <h1>Alliance Girls High School</h1>
                <p>Excellence in Education Since 1975</p>
            </div>
            <div class="report-title">
                <h2>ACADEMIC REPORT</h2>
                <p>Term 2 - Comprehensive Summary</p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Subjects Section -->
            <div class="subjects-section">
                <h2><i class="fas fa-book-open"></i> Term 2 Academic Performance</h2>
                
                <!-- Term Navigation -->
                <div class="term-navigation no-print">
                    <button class="term-btn" data-term="1">Term 1</button>
                    <button class="term-btn active" data-term="2">Term 2</button>
                    <button class="term-btn" data-term="3">Term 3</button>
                </div>

                <div class="subjects-table-container">
                    <table class="subjects-table">
                        <thead>
                            <tr>
                                <th colspan="15" class="term-header">TERM 2 ASSESSMENTS - COMPLETE SUBJECT LIST</th>
                            </tr>
                            <tr>
                                <th class="subject-col">Subject (Code)</th>
                                
                                <!-- Opener Exam -->
                                <th colspan="4" class="exam-type-header">OPENER EXAM</th>
                                
                                <!-- Mid Term -->
                                <th colspan="4" class="exam-type-header">MID TERM</th>
                                
                                <!-- End Term -->
                                <th colspan="4" class="exam-type-header">END TERM</th>
                                
                                <!-- Overall -->
                                <th class="term-header">Term Avg</th>
                                <th class="term-header">Grade</th>
                            </tr>
                            <tr>
                                <th class="subject-col">Subject Details</th>
                                
                                <!-- Paper Headers -->
                                <th>P1</th><th>P2</th><th>P3</th><th>Avg</th>
                                <th>P1</th><th>P2</th><th>P3</th><th>Avg</th>
                                <th>P1</th><th>P2</th><th>P3</th><th>Avg</th>
                                
                                <!-- Overall -->
                                <th>Avg</th>
                                <th>Grd</th>
                            </tr>
                        </thead>
                        <tbody id="subjectsTableTerm2">
                            <!-- Term 2 subjects populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Right Column -->
            <div class="grading-section">
                <div class="performance-graph">
                    <h3><i class="fas fa-chart-line"></i> Term 2 Performance</h3>
                    <div class="graph-container">
                        <canvas id="performanceChartTerm2"></canvas>
                    </div>
                </div>

                <div class="comments-box">
                    <h3><i class="fas fa-user-tie"></i> Head of Department Comments</h3>
                    <textarea id="hodCommentsTerm2">Consistent improvement noted from Term 1. Strong analytical skills in sciences. Shows excellent leadership in group activities. Should focus on humanities subjects for balanced performance.</textarea>
                </div>
            </div>
        </div>

        <!-- Bottom Section -->
        <div class="bottom-section">
            <div class="attendance-section">
                <h3><i class="fas fa-calendar-check"></i> Term 2 Attendance</h3>
                <table class="attendance-table">
                    <tr>
                        <td>Total School Days</td>
                        <td><input type="number" id="totalDaysTerm2" value="45" min="0"></td>
                    </tr>
                    <tr>
                        <td>Days Attended</td>
                        <td><input type="number" id="daysAttendedTerm2" value="44" min="0"></td>
                    </tr>
                    <tr>
                        <td>Days Absent</td>
                        <td><input type="number" id="daysAbsentTerm2" value="1" min="0" readonly></td>
                    </tr>
                    <tr>
                        <td>Attendance Rate</td>
                        <td><input type="text" id="attendanceRateTerm2" value="97.8%" readonly></td>
                    </tr>
                </table>
            </div>

            <div class="ranks-section">
                <h3><i class="fas fa-trophy"></i> Term 2 Ranking</h3>
                <div class="ranks-grid">
                    <div class="rank-item">
                        <label>Stream Rank</label>
                        <div class="rank-value">3</div>
                        <div class="rank-total">out of 45 students in Science A</div>
                    </div>
                    <div class="rank-item">
                        <label>Overall Rank</label>
                        <div class="rank-value">12</div>
                        <div class="rank-total">out of 280 Grade 12 students</div>
                    </div>
                </div>
            </div>

            <div class="final-grades-section">
                <h3><i class="fas fa-chart-line"></i> Term 2 Grades</h3>
                <div class="final-grades-grid">
                    <div class="final-grade-item">
                        <label>Term Average</label>
                        <div class="final-grade-value" id="termAverageTerm2">87.2</div>
                    </div>
                    <div class="final-grade-item">
                        <label>Term Grade</label>
                        <div class="final-grade-value" id="termGradeTerm2">A</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Security Notice -->
        <div class="security-notice">
            <i class="fas fa-shield-alt"></i> SECURE DOCUMENT • TERM 2 • PAGE 2 OF 3
        </div>
    </div>

    <!-- Page 3: Term 3 & Summary -->
    <div class="report-card-container page" id="page3">
        <!-- Holographic Overlay for Security -->
        <div class="holographic-overlay"></div>
        
        <!-- Complex Background Pattern -->
        <div class="complex-pattern"></div>
        
        <!-- Security Background Elements -->
        <div class="security-background">
            <div class="micro-pattern"></div>
            <div class="watermark">FINAL REPORT</div>
            <div class="serial-number">SN: AGHS-RC-2025-0247-5A8B</div>
        </div>

        <!-- Header Section -->
        <div class="header">
            <div class="school-logo">
                <img src="badge.png" alt="Alliance Girls High School Badge" onerror="this.onerror=null; this.src='https://api.dicebear.com/7.x/shapes/svg?seed=AllianceGirls'">
            </div>
            <div class="school-name">
                <h1>Alliance Girls High School</h1>
                <p>Excellence in Education Since 1975</p>
            </div>
            <div class="report-title">
                <h2>ACADEMIC REPORT</h2>
                <p>Term 3 & Annual Summary</p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Subjects Section -->
            <div class="subjects-section">
                <h2><i class="fas fa-book-open"></i> Term 3 Academic Performance</h2>
                
                <!-- Term Navigation -->
                <div class="term-navigation no-print">
                    <button class="term-btn" data-term="1">Term 1</button>
                    <button class="term-btn" data-term="2">Term 2</button>
                    <button class="term-btn active" data-term="3">Term 3</button>
                </div>

                <div class="subjects-table-container">
                    <table class="subjects-table">
                        <thead>
                            <tr>
                                <th colspan="15" class="term-header">TERM 3 ASSESSMENTS - COMPLETE SUBJECT LIST</th>
                            </tr>
                            <tr>
                                <th class="subject-col">Subject (Code)</th>
                                
                                <!-- Opener Exam -->
                                <th colspan="4" class="exam-type-header">OPENER EXAM</th>
                                
                                <!-- Mid Term -->
                                <th colspan="4" class="exam-type-header">MID TERM</th>
                                
                                <!-- End Term -->
                                <th colspan="4" class="exam-type-header">END TERM</th>
                                
                                <!-- Overall -->
                                <th class="term-header">Term Avg</th>
                                <th class="term-header">Grade</th>
                            </tr>
                            <tr>
                                <th class="subject-col">Subject Details</th>
                                
                                <!-- Paper Headers -->
                                <th>P1</th><th>P2</th><th>P3</th><th>Avg</th>
                                <th>P1</th><th>P2</th><th>P3</th><th>Avg</th>
                                <th>P1</th><th>P2</th><th>P3</th><th>Avg</th>
                                
                                <!-- Overall -->
                                <th>Avg</th>
                                <th>Grd</th>
                            </tr>
                        </thead>
                        <tbody id="subjectsTableTerm3">
                            <!-- Term 3 subjects populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Right Column -->
            <div class="grading-section">
                <div class="performance-graph">
                    <h3><i class="fas fa-chart-line"></i> Annual Performance Trend</h3>
                    <div class="graph-container">
                        <canvas id="performanceChartAnnual"></canvas>
                    </div>
                </div>

                <div class="comments-box">
                    <h3><i class="fas fa-user-tie"></i> Principal's Final Comments</h3>
                    <textarea id="principalComments">Outstanding academic performance throughout the year. Consistent improvement across all terms. Shows great potential for STEM fields at university level. A model student with exemplary conduct. Recommended for university scholarship consideration.</textarea>
                </div>
            </div>
        </div>

        <!-- Bottom Section -->
        <div class="bottom-section">
            <div class="attendance-section">
                <h3><i class="fas fa-calendar-check"></i> Annual Attendance</h3>
                <table class="attendance-table">
                    <tr>
                        <td>Total School Days</td>
                        <td><input type="number" id="totalDaysAnnual" value="135" min="0"></td>
                    </tr>
                    <tr>
                        <td>Days Attended</td>
                        <td><input type="number" id="daysAttendedAnnual" value="132" min="0"></td>
                    </tr>
                    <tr>
                        <td>Days Absent</td>
                        <td><input type="number" id="daysAbsentAnnual" value="3" min="0" readonly></td>
                    </tr>
                    <tr>
                        <td>Attendance Rate</td>
                        <td><input type="text" id="attendanceRateAnnual" value="97.8%" readonly></td>
                    </tr>
                </table>
            </div>

            <div class="ranks-section">
                <h3><i class="fas fa-trophy"></i> Annual Ranking</h3>
                <div class="ranks-grid">
                    <div class="rank-item">
                        <label>Stream Rank</label>
                        <div class="rank-value">3</div>
                        <div class="rank-total">out of 45 students in Science A</div>
                    </div>
                    <div class="rank-item">
                        <label>Overall Rank</label>
                        <div class="rank-value">12</div>
                        <div class="rank-total">out of 280 Grade 12 students</div>
                    </div>
                </div>
            </div>

            <div class="final-grades-section">
                <h3><i class="fas fa-chart-line"></i> Final Grades</h3>
                <div class="final-grades-grid">
                    <div class="final-grade-item">
                        <label>Annual Average</label>
                        <div class="final-grade-value" id="annualAverage">86.3</div>
                    </div>
                    <div class="final-grade-item">
                        <label>Overall Grade</label>
                        <div class="final-grade-value" id="overallGrade">A</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Signature Section -->
        <div class="signature-section">
            <div class="signature-box">
                <h4>Class Teacher's Signature</h4>
                <p>I certify that all academic information is accurate</p>
                <div class="signature-line"></div>
                <div class="signature-name">Mr. Robert Chen</div>
                <div class="signature-title">Class Teacher, Science Stream A</div>
            </div>
            <div class="signature-box">
                <h4>Principal's Signature</h4>
                <p>Approved and verified by school administration</p>
                <div class="signature-line"></div>
                <div class="signature-name">Dr. Elizabeth Muthoni</div>
                <div class="signature-title">Principal, Alliance Girls High School</div>
            </div>
        </div>

        <!-- Security QR Code -->
        <div class="security-qr">
            <div class="qr-container">
                <div class="qr-code"></div>
                <p><i class="fas fa-shield-alt"></i> VERIFY AUTHENTICITY: SCAN QR CODE</p>
                <p style="font-size: 13px; color: #777; margin-top: 8px;">UV-reactive • Holographic • Micro-text • Digital Signature</p>
            </div>
        </div>

        <!-- Control Buttons -->
        <div class="controls no-print">
            <button class="btn btn-calculate" id="calculateBtn">
                <i class="fas fa-calculator"></i> Calculate All Grades
            </button>
            <button class="btn btn-print" id="printBtn">
                <i class="fas fa-print"></i> Print Report Card
            </button>
            <button class="btn btn-reset" id="resetBtn">
                <i class="fas fa-redo"></i> Reset All Grades
            </button>
        </div>

        <!-- Security Notice -->
        <div class="security-notice">
            <i class="fas fa-shield-alt"></i> SECURE DOCUMENT • FINAL REPORT • PAGE 3 OF 3
        </div>
    </div>

    <script>
        // Complete list of subjects with all exam papers
        const subjects = [
            // Core Subjects
            { name: "English Language", code: "ENG", papers: 3 },
            { name: "Kiswahili", code: "KIS", papers: 3 },
            { name: "Mathematics", code: "MAT", papers: 3 },
            { name: "Biology", code: "BIO", papers: 3 },
            { name: "Chemistry", code: "CHE", papers: 3 },
            { name: "Physics", code: "PHY", papers: 3 },
            { name: "Geography", code: "GEO", papers: 2 },
            { name: "History & Government", code: "HIS", papers: 2 },
            
            // Humanities
            { name: "Christian Religious Education", code: "CRE", papers: 2 },
            { name: "Islamic Religious Education", code: "IRE", papers: 2 },
            { name: "Hindu Religious Education", code: "HRE", papers: 2 },
            { name: "Business Studies", code: "BUS", papers: 2 },
            { name: "Agriculture", code: "AGR", papers: 3 },
            { name: "Computer Studies", code: "CST", papers: 3 },
            
            // Languages
            { name: "French", code: "FRE", papers: 2 },
            { name: "German", code: "GER", papers: 2 },
            { name: "Arabic", code: "ARB", papers: 2 },
            { name: "Mandarin Chinese", code: "MAN", papers: 2 },
            { name: "Kenya Sign Language", code: "KSL", papers: 2 },
            
            // Technical & Applied
            { name: "Home Science", code: "HOM", papers: 3 },
            { name: "Art & Design", code: "ART", papers: 2 },
            { name: "Music", code: "MUS", papers: 2 },
            { name: "Physical Education", code: "PED", papers: 2 },
            
            // Optional Subjects
            { name: "Aviation Technology", code: "AVI", papers: 2 },
            { name: "Marine Engineering", code: "MAR", papers: 2 },
            { name: "Building Construction", code: "BLD", papers: 2 },
            { name: "Power Mechanics", code: "PWR", papers: 2 },
            { name: "Electricity", code: "ELE", papers: 2 },
            { name: "Drawing & Design", code: "DRW", papers: 2 }
        ];

        // Grading system
        const gradingSystem = [
            { grade: "A", min_score: 80, max_score: 100, achievement_level: "Excellent", color_code: "#10B981" },
            { grade: "B", min_score: 70, max_score: 79, achievement_level: "Very Good", color_code: "#34D399" },
            { grade: "C", min_score: 60, max_score: 69, achievement_level: "Average", color_code: "#FBBF24" },
            { grade: "D", min_score: 50, max_score: 59, achievement_level: "Below Average", color_code: "#F59E0B" },
            { grade: "E", min_score: 40, max_score: 49, achievement_level: "Marginal Pass", color_code: "#F97316" },
            { grade: "F", min_score: 0, max_score: 39, achievement_level: "Fail", color_code: "#EF4444" }
        ];

        // Generate random grades for subjects
        function generateGradesForTerm(termIndex) {
            const grades = {};
            subjects.forEach(subject => {
                grades[subject.code] = {
                    opener: generatePaperGrades(subject.papers),
                    mid: generatePaperGrades(subject.papers),
                    end: generatePaperGrades(subject.papers)
                };
            });
            return grades;
        }

        function generatePaperGrades(numPapers) {
            const grades = [];
            for (let i = 0; i < numPapers; i++) {
                grades.push(Math.floor(Math.random() * 20) + 75); // 75-95 range
            }
            // Fill remaining papers with 0 if less than 3
            while (grades.length < 3) {
                grades.push(0);
            }
            return grades;
        }

        // Initialize grades for all terms
        let termGrades = {
            1: generateGradesForTerm(1),
            2: generateGradesForTerm(2),
            3: generateGradesForTerm(3)
        };

        // DOM Elements
        let subjectsTableTerm1 = document.getElementById('subjectsTableTerm1');
        let subjectsTableTerm2 = document.getElementById('subjectsTableTerm2');
        let subjectsTableTerm3 = document.getElementById('subjectsTableTerm3');
        let gradingSystemContainer = document.getElementById('gradingSystem');
        let performanceCharts = {};

        // Get grade letter based on score
        function getGradeLetter(score) {
            if (score >= 80) return "A";
            else if (score >= 75) return "A-";
            else if (score >= 70) return "B+";
            else if (score >= 65) return "B";
            else if (score >= 60) return "B-";
            else if (score >= 55) return "C+";
            else if (score >= 50) return "C";
            else if (score >= 45) return "C-";
            else if (score >= 40) return "D+";
            else if (score >= 35) return "D";
            else if (score >= 30) return "D-";
            else return "E";
        }

        // Get grade color based on score
        function getGradeColor(score) {
            if (score >= 80) return "#10B981";
            else if (score >= 70) return "#34D399";
            else if (score >= 60) return "#FBBF24";
            else if (score >= 50) return "#F59E0B";
            else if (score >= 40) return "#F97316";
            else return "#EF4444";
        }

        // Calculate average of papers
        function calculateAverage(grades) {
            const validGrades = grades.filter(grade => grade > 0);
            if (validGrades.length === 0) return 0;
            const sum = validGrades.reduce((total, grade) => total + grade, 0);
            return sum / validGrades.length;
        }

        // Calculate term average for a subject
        function calculateTermSubjectAverage(subjectGrades) {
            const openerAvg = calculateAverage(subjectGrades.opener);
            const midAvg = calculateAverage(subjectGrades.mid);
            const endAvg = calculateAverage(subjectGrades.end);
            
            const termAverages = [openerAvg, midAvg, endAvg].filter(avg => avg > 0);
            if (termAverages.length === 0) return 0;
            
            return calculateAverage(termAverages);
        }

        // Populate subjects table for a term
        function populateSubjectsTable(tableElement, term) {
            tableElement.innerHTML = '';
            
            subjects.forEach(subject => {
                const subjectGrades = termGrades[term][subject.code];
                const openerAvg = calculateAverage(subjectGrades.opener);
                const midAvg = calculateAverage(subjectGrades.mid);
                const endAvg = calculateAverage(subjectGrades.end);
                const termAvg = calculateTermSubjectAverage(subjectGrades);
                const termGrade = getGradeLetter(termAvg);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="subject-cell">
                        <strong>${subject.name}</strong>
                        <span class="subject-code">${subject.code}</span>
                    </td>
                    
                    <!-- Opener Exam -->
                    <td><input type="number" class="grade-input" min="0" max="100" 
                           data-term="${term}" data-subject="${subject.code}" data-exam="opener" data-paper="0"
                           value="${subjectGrades.opener[0] || ''}"></td>
                    <td><input type="number" class="grade-input" min="0" max="100" 
                           data-term="${term}" data-subject="${subject.code}" data-exam="opener" data-paper="1"
                           value="${subjectGrades.opener[1] || ''}"></td>
                    <td><input type="number" class="grade-input" min="0" max="100" 
                           data-term="${term}" data-subject="${subject.code}" data-exam="opener" data-paper="2"
                           value="${subjectGrades.opener[2] || ''}"></td>
                    <td class="paper-average" id="avg-${term}-${subject.code}-opener">${openerAvg.toFixed(1)}</td>
                    
                    <!-- Mid Term -->
                    <td><input type="number" class="grade-input" min="0" max="100" 
                           data-term="${term}" data-subject="${subject.code}" data-exam="mid" data-paper="0"
                           value="${subjectGrades.mid[0] || ''}"></td>
                    <td><input type="number" class="grade-input" min="0" max="100" 
                           data-term="${term}" data-subject="${subject.code}" data-exam="mid" data-paper="1"
                           value="${subjectGrades.mid[1] || ''}"></td>
                    <td><input type="number" class="grade-input" min="0" max="100" 
                           data-term="${term}" data-subject="${subject.code}" data-exam="mid" data-paper="2"
                           value="${subjectGrades.mid[2] || ''}"></td>
                    <td class="paper-average" id="avg-${term}-${subject.code}-mid">${midAvg.toFixed(1)}</td>
                    
                    <!-- End Term -->
                    <td><input type="number" class="grade-input" min="0" max="100" 
                           data-term="${term}" data-subject="${subject.code}" data-exam="end" data-paper="0"
                           value="${subjectGrades.end[0] || ''}"></td>
                    <td><input type="number" class="grade-input" min="0" max="100" 
                           data-term="${term}" data-subject="${subject.code}" data-exam="end" data-paper="1"
                           value="${subjectGrades.end[1] || ''}"></td>
                    <td><input type="number" class="grade-input" min="0" max="100" 
                           data-term="${term}" data-subject="${subject.code}" data-exam="end" data-paper="2"
                           value="${subjectGrades.end[2] || ''}"></td>
                    <td class="paper-average" id="avg-${term}-${subject.code}-end">${endAvg.toFixed(1)}</td>
                    
                    <!-- Term Average & Grade -->
                    <td class="subject-average" id="avg-${term}-${subject.code}">${termAvg.toFixed(1)}</td>
                    <td class="grade-letter" id="grade-${term}-${subject.code}" style="color: ${getGradeColor(termAvg)}; font-weight: bold;">${termGrade}</td>
                `;
                
                tableElement.appendChild(row);
                
                // Update colors
                updateGradeColor(document.getElementById(`avg-${term}-${subject.code}-opener`), openerAvg);
                updateGradeColor(document.getElementById(`avg-${term}-${subject.code}-mid`), midAvg);
                updateGradeColor(document.getElementById(`avg-${term}-${subject.code}-end`), endAvg);
                updateGradeColor(document.getElementById(`avg-${term}-${subject.code}`), termAvg);
            });
        }

        // Update grade input
        function updateGradeInput(event) {
            const input = event.target;
            const term = parseInt(input.dataset.term);
            const subjectCode = input.dataset.subject;
            const exam = input.dataset.exam;
            const paper = parseInt(input.dataset.paper);
            
            // Update the grade
            termGrades[term][subjectCode][exam][paper] = parseFloat(input.value) || 0;
            
            // Recalculate averages for this subject in this term
            updateSubjectAverages(term, subjectCode);
            
            // Update overall calculations
            calculateAllGrades();
        }

        // Update subject averages
        function updateSubjectAverages(term, subjectCode) {
            const subjectGrades = termGrades[term][subjectCode];
            const openerAvg = calculateAverage(subjectGrades.opener);
            const midAvg = calculateAverage(subjectGrades.mid);
            const endAvg = calculateAverage(subjectGrades.end);
            const termAvg = calculateTermSubjectAverage(subjectGrades);
            const termGrade = getGradeLetter(termAvg);
            
            // Update display
            document.getElementById(`avg-${term}-${subjectCode}-opener`).textContent = openerAvg.toFixed(1);
            document.getElementById(`avg-${term}-${subjectCode}-mid`).textContent = midAvg.toFixed(1);
            document.getElementById(`avg-${term}-${subjectCode}-end`).textContent = endAvg.toFixed(1);
            document.getElementById(`avg-${term}-${subjectCode}`).textContent = termAvg.toFixed(1);
            document.getElementById(`grade-${term}-${subjectCode}`).textContent = termGrade;
            document.getElementById(`grade-${term}-${subjectCode}`).style.color = getGradeColor(termAvg);
            
            // Update colors
            updateGradeColor(document.getElementById(`avg-${term}-${subjectCode}-opener`), openerAvg);
            updateGradeColor(document.getElementById(`avg-${term}-${subjectCode}-mid`), midAvg);
            updateGradeColor(document.getElementById(`avg-${term}-${subjectCode}-end`), endAvg);
            updateGradeColor(document.getElementById(`avg-${term}-${subjectCode}`), termAvg);
        }

        // Update grade color
        function updateGradeColor(element, grade) {
            if (!element) return;
            
            element.classList.remove('grade-a', 'grade-b', 'grade-c', 'grade-d', 'grade-e', 'grade-f');
            
            if (grade >= 80) element.classList.add('grade-a');
            else if (grade >= 70) element.classList.add('grade-b');
            else if (grade >= 60) element.classList.add('grade-c');
            else if (grade >= 50) element.classList.add('grade-d');
            else if (grade >= 40) element.classList.add('grade-e');
            else element.classList.add('grade-f');
        }

        // Calculate all grades
        function calculateAllGrades() {
            // Calculate term averages
            const termAverages = {};
            const subjectTermAverages = {};
            
            [1, 2, 3].forEach(term => {
                const subjectAverages = [];
                subjects.forEach(subject => {
                    const termAvg = calculateTermSubjectAverage(termGrades[term][subject.code]);
                    if (termAvg > 0) {
                        subjectAverages.push(termAvg);
                    }
                });
                
                termAverages[term] = subjectAverages.length > 0 ? 
                    calculateAverage(subjectAverages) : 0;
            });
            
            // Update term averages display
            document.getElementById('termAverageTerm1').textContent = termAverages[1].toFixed(1);
            document.getElementById('termAverageTerm2').textContent = termAverages[2].toFixed(1);
            document.getElementById('termAverageTerm3').textContent = termAverages[3].toFixed(1);
            
            // Update term grades
            document.getElementById('termGradeTerm1').textContent = getGradeLetter(termAverages[1]);
            document.getElementById('termGradeTerm2').textContent = getGradeLetter(termAverages[2]);
            
            // Calculate annual average
            const annualAverage = calculateAverage([termAverages[1], termAverages[2], termAverages[3]]);
            document.getElementById('annualAverage').textContent = annualAverage.toFixed(1);
            document.getElementById('overallGrade').textContent = getGradeLetter(annualAverage);
            
            // Update performance charts
            updatePerformanceCharts(termAverages);
            
            // Update attendance
            updateAttendance();
        }

        // Initialize performance charts
        function initPerformanceCharts() {
            const ctx1 = document.getElementById('performanceChartTerm1').getContext('2d');
            const ctx2 = document.getElementById('performanceChartTerm2').getContext('2d');
            const ctxAnnual = document.getElementById('performanceChartAnnual').getContext('2d');
            
            // Sample data - in real app, this would come from actual grades
            const sampleData = {
                subjects: ['Math', 'Science', 'English', 'Humanities', 'Languages', 'Technical'],
                term1: [84.5, 87.2, 88.1, 82.3, 85.6, 89.4],
                term2: [87.2, 89.5, 89.8, 85.1, 88.3, 91.2],
                term3: [88.5, 91.2, 90.5, 86.7, 89.8, 92.3]
            };
            
            // Term 1 Chart
            performanceCharts.term1 = new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: sampleData.subjects,
                    datasets: [{
                        label: 'Term 1 Scores',
                        data: sampleData.term1,
                        backgroundColor: 'rgba(7, 88, 36, 0.7)',
                        borderColor: '#075824',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'Term 1 Subject Performance', font: { size: 14 } }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 70,
                            max: 100,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' },
                            ticks: { callback: value => value + '%' }
                        }
                    }
                }
            });
            
            // Term 2 Chart
            performanceCharts.term2 = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: sampleData.subjects,
                    datasets: [{
                        label: 'Term 2 Scores',
                        data: sampleData.term2,
                        backgroundColor: 'rgba(55, 116, 55, 0.7)',
                        borderColor: '#377437',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'Term 2 Subject Performance', font: { size: 14 } }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 70,
                            max: 100,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' },
                            ticks: { callback: value => value + '%' }
                        }
                    }
                }
            });
            
            // Annual Chart
            performanceCharts.annual = new Chart(ctxAnnual, {
                type: 'line',
                data: {
                    labels: ['Term 1', 'Term 2', 'Term 3'],
                    datasets: [
                        {
                            label: 'Student Average',
                            data: [84.5, 87.2, 88.5],
                            borderColor: '#075824',
                            backgroundColor: 'rgba(7, 88, 36, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.3
                        },
                        {
                            label: 'Class Average',
                            data: [82.3, 83.7, 84.2],
                            borderColor: '#9BAE30',
                            backgroundColor: 'rgba(155, 174, 48, 0.1)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top', labels: { font: { size: 12 } } }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 70,
                            max: 100,
                            grid: { color: 'rgba(0, 0, 0, 0.05)' },
                            ticks: { callback: value => value + '%' }
                        }
                    }
                }
            });
        }

        // Update performance charts
        function updatePerformanceCharts(termAverages) {
            if (performanceCharts.annual) {
                performanceCharts.annual.data.datasets[0].data = [
                    termAverages[1] || 0,
                    termAverages[2] || 0,
                    termAverages[3] || 0
                ];
                performanceCharts.annual.update();
            }
        }

        // Update attendance
        function updateAttendance() {
            // Update term attendance
            [1, 2, 3].forEach(term => {
                const totalDays = document.getElementById(`totalDaysTerm${term}`).value;
                const daysAttended = document.getElementById(`daysAttendedTerm${term}`).value;
                const daysAbsent = document.getElementById(`daysAbsentTerm${term}`);
                const attendanceRate = document.getElementById(`attendanceRateTerm${term}`);
                
                daysAbsent.value = Math.max(0, totalDays - daysAttended);
                const rate = totalDays > 0 ? (daysAttended / totalDays * 100).toFixed(1) : 0;
                attendanceRate.value = `${rate}%`;
            });
            
            // Update annual attendance
            const totalDaysAnnual = document.getElementById('totalDaysAnnual');
            const daysAttendedAnnual = document.getElementById('daysAttendedAnnual');
            const daysAbsentAnnual = document.getElementById('daysAbsentAnnual');
            const attendanceRateAnnual = document.getElementById('attendanceRateAnnual');
            
            let totalDays = 0;
            let totalAttended = 0;
            
            [1, 2, 3].forEach(term => {
                totalDays += parseInt(document.getElementById(`totalDaysTerm${term}`).value) || 0;
                totalAttended += parseInt(document.getElementById(`daysAttendedTerm${term}`).value) || 0;
            });
            
            totalDaysAnnual.value = totalDays;
            daysAttendedAnnual.value = totalAttended;
            daysAbsentAnnual.value = Math.max(0, totalDays - totalAttended);
            const rate = totalDays > 0 ? (totalAttended / totalDays * 100).toFixed(1) : 0;
            attendanceRateAnnual.value = `${rate}%`;
        }

        // Populate grading system
        function populateGradingSystem() {
            gradingSystemContainer.innerHTML = '';
            
            gradingSystem.forEach(item => {
                const gradeItem = document.createElement('div');
                gradeItem.className = 'grade-item';
                gradeItem.style.borderLeft = `5px solid ${item.color_code}`;
                gradeItem.innerHTML = `
                    <div>
                        <strong style="color: ${item.color_code}; font-size: 16px;">${item.grade}</strong><br>
                        <small>${item.achievement_level}</small>
                    </div>
                    <div class="grade-range">${item.min_score}–${item.max_score}</div>
                `;
                gradeItem.title = `${item.achievement_level}: ${item.min_score}-${item.max_score}%`;
                gradingSystemContainer.appendChild(gradeItem);
            });
        }

        // Page navigation
        function navigateToPage(pageNumber) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(`page${pageNumber}`).classList.add('active');
            
            // Update navigation buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.nav-btn[data-page="${pageNumber}"]`).classList.add('active');
            
            // Update scroll dots
            document.querySelectorAll('.scroll-dot').forEach(dot => {
                dot.classList.remove('active');
            });
            document.querySelector(`.scroll-dot[data-page="${pageNumber}"]`).classList.add('active');
            
            // Scroll to top of page
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Initialize the application
        function init() {
            // Populate all tables
            populateSubjectsTable(subjectsTableTerm1, 1);
            populateSubjectsTable(subjectsTableTerm2, 2);
            populateSubjectsTable(subjectsTableTerm3, 3);
            
            // Populate grading system
            populateGradingSystem();
            
            // Initialize performance charts
            initPerformanceCharts();
            
            // Calculate initial grades
            calculateAllGrades();
            
            // Set up event listeners for grade inputs
            document.querySelectorAll('.grade-input').forEach(input => {
                input.addEventListener('change', updateGradeInput);
                input.addEventListener('input', updateGradeInput);
            });
            
            // Set up attendance input listeners
            document.querySelectorAll('input[type="number"]').forEach(input => {
                if (input.id.includes('Days')) {
                    input.addEventListener('change', updateAttendance);
                }
            });
            
            // Set up term navigation
            document.querySelectorAll('.term-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const term = this.dataset.term;
                    navigateToPage(term);
                });
            });
            
            // Set up page navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const page = this.dataset.page;
                    navigateToPage(page);
                });
            });
            
            // Set up scroll dot navigation
            document.querySelectorAll('.scroll-dot').forEach(dot => {
                dot.addEventListener('click', function() {
                    const page = this.dataset.page;
                    navigateToPage(page);
                });
            });
            
            // Set up control buttons
            document.getElementById('calculateBtn').addEventListener('click', calculateAllGrades);
            document.getElementById('printBtn').addEventListener('click', printReport);
            document.getElementById('resetBtn').addEventListener('click', resetGrades);
            
            // Initialize scroll indicator based on scroll position
            window.addEventListener('scroll', updateScrollIndicator);
        }

        // Update scroll indicator based on page visibility
        function updateScrollIndicator() {
            const pages = [1, 2, 3];
            let visiblePage = 1;
            
            pages.forEach(page => {
                const pageElement = document.getElementById(`page${page}`);
                const rect = pageElement.getBoundingClientRect();
                if (rect.top < window.innerHeight / 2 && rect.bottom > window.innerHeight / 2) {
                    visiblePage = page;
                }
            });
            
            // Update scroll dots
            document.querySelectorAll('.scroll-dot').forEach(dot => {
                dot.classList.remove('active');
            });
            document.querySelector(`.scroll-dot[data-page="${visiblePage}"]`).classList.add('active');
        }

        // Print report
        function printReport() {
            // Calculate everything before printing
            calculateAllGrades();
            
            // Add print-specific styling
            const printStyle = document.createElement('style');
            printStyle.innerHTML = `
                @media print {
                    body * {
                        visibility: hidden;
                    }
                    .report-card-container, .report-card-container * {
                        visibility: visible;
                    }
                    .report-card-container {
                        position: absolute;
                        left: 0;
                        top: 0;
                        width: 210mm;
                        min-width: 210mm;
                        max-width: 210mm;
                        box-shadow: none;
                        border-radius: 0;
                        padding: 25px 30px;
                        margin: 0;
                        page-break-after: always;
                    }
                    .no-print, .holographic-overlay, .btn, .security-bg-pattern, 
                    .scroll-indicator, .floating-nav, .term-navigation {
                        display: none !important;
                    }
                    .page {
                        display: block !important;
                        opacity: 1 !important;
                    }
                    .subjects-table {
                        font-size: 10px;
                    }
                    .subjects-table input {
                        border: 1px solid #ccc;
                        padding: 4px;
                        width: 50px;
                    }
                }
            `;
            document.head.appendChild(printStyle);
            
            window.print();
            
            // Remove the print style after printing
            setTimeout(() => {
                document.head.removeChild(printStyle);
            }, 100);
        }

        // Reset all grades
        function resetGrades() {
            if (confirm('Are you sure you want to reset all grades to their default values?')) {
                // Regenerate grades
                termGrades = {
                    1: generateGradesForTerm(1),
                    2: generateGradesForTerm(2),
                    3: generateGradesForTerm(3)
                };
                
                // Repopulate tables
                populateSubjectsTable(subjectsTableTerm1, 1);
                populateSubjectsTable(subjectsTableTerm2, 2);
                populateSubjectsTable(subjectsTableTerm3, 3);
                
                // Recalculate all grades
                calculateAllGrades();
                
                // Update grade input listeners
                document.querySelectorAll('.grade-input').forEach(input => {
                    input.addEventListener('change', updateGradeInput);
                    input.addEventListener('input', updateGradeInput);
                });
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>